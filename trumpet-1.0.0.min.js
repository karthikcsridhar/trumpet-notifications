'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}(function(a){'use strict';function b(G,H){window.localStorage&&localStorage.setItem(G,H)}function c(G){return window.localStorage?localStorage.getItem(G):null}function d(){''===p||p||console.error(A+' requires a notificationsEndpoint to GET notifications from.'),r&&(0>r||r.constructor!==Number)&&console.error(A+' can only accept a positive integer as pollInterval.'),u&&u.constructor!==Function&&console.error(A+' can only accept a function as callback.'),v&&!a.Noty&&console.error(A+' - You have asked to use the NotyJS plugin, but it is not found. Please make sure to include it before Trumpet plugin. Else disable Noty.'),D!==F.API_TYPE.WEB_SOCKET||a.io||console.error(A+' - requires socket.io to support websockets.')}function f(){if(D==F.API_TYPE.SSE){var G=o+p,K=new EventSource(G);K.addEventListener('trumpet',function(L){g(JSON.parse(L.data))})}else if(D===F.API_TYPE.WEB_SOCKET){var G=o+p,H=io.connect(G);H.on('error',function(L){console.error(L)}),H.on('trumpet',function(L){g(L)})}else{var I=new XMLHttpRequest,G=p+'?ts='+new Date().getTime();if(q)for(var J in q)q.hasOwnProperty(J)&&I.setRequestHeader(J,q[J]);I.open('GET',G,!0),I.onload=function(){g(JSON.parse(I.responseText)),a.stopTrumpeting||setTimeout(function(){f()},r)},I.send()}}function g(G){var H,I=[];for(H in G)if(G.hasOwnProperty(H)&&!c(B+H)){var J={title:G[H][z.messageField],message:G[H][z.messageField],type:G[H][z.notificationTypeField],timestamp:G[H][z.timeStampField]};b(B+H,J),I.push(J),h(J)}u&&u.constructor===Function&&u(I)}function h(G){v&&a.Noty?j(G):i(G)}function i(G){var H,I,J,K;H=document.createElement('div'),H.classList.add('trumpet-notif-'+G.type),H.classList.add('trumpetItemContainer'),I=document.createElement('strong'),I.textContent=G.type,H.appendChild(I),J=document.createElement('span'),J.textContent=G.message,H.appendChild(J),K=document.createElement('div'),K.className='trumpetClose',K.innerHTML='&times;',H.appendChild(K),G.close=K,G.node=H,x.appendChild(G.node),G.close.addEventListener('click',function(){var L=this.parentNode;L.parentNode.removeChild(L)})}function j(G){v&&a.Noty&&(a.mojs&&(w.animation=E.notyMojsAnimation),w.text=G.message,w.type=G.type,new Noty(w).show())}function k(){var G;x=document.getElementById('trumpet-container'),x||(G=document.createElement('div'),document.body.insertBefore(G,document.body.firstChild),x=G,y?x.classList.add('trumpet-notif-'+y):x.classList.add('trumpet-notif-topRight'))}function l(){var H,G=document.createElement('style');G.appendChild(document.createTextNode('')),document.body.appendChild(G),H=G.sheet,m(H,'.trumpet-notif-alert','background-color: #ffe5fd; border-color: #f1d8ef; color: #a94442;'),m(H,'.trumpet-notif-info','background-color: #7f7eff; border-color: #7473e8; color: #fff;'),m(H,'.trumpet-notif-success','background-color: #60A917; border-color: #4d8712; color: #fff;'),m(H,'.trumpet-notif-error','background-color: #f51f1f; border-color: #d82d2d; color: #fff;'),m(H,'.trumpet-notif-warning','background-color: #ffae42; border-color: #e89f3c; color: #fff;'),m(H,'.trumpetItemContainer','position: relative; border-radius: 2px; border: 1px solid; font-size: 14px; padding: 10px 0 10px 14px; font-family: \'Helvetica Neue\', Helvetica, Arial, sans-serif; margin: 10px 0;line-height: normal;'),m(H,'.trumpetItemContainer strong','float: left; margin-right: 15px; line-height: 15px'),m(H,'.trumpetItemContainer span','display:table-cell; padding-right: 35px;'),m(H,'.trumpetClose','position: absolute; right: 10px; top: 0; cursor: pointer; font-size: 26px; font-weight: bold;'),m(H,'.trumpet-notif-topRight','width: 340px; position: absolute; right: 10px; top: 5px;'),m(H,'.trumpet-notif-top','width: 340px; left: 50%; transform: translate(-170px,0); position: absolute; top: 5px;'),m(H,'.trumpet-notif-bottom','width: 340px; left: 50%; transform: translate(-170px,0); position: absolute; bottom: 5px;'),m(H,'.trumpet-notif-bottomRight','width: 340px; position: absolute; right: 10px; bottom: 5px;'),m(H,'.trumpet-notif-topLeft','width: 340px; position: absolute; left: 10px; top: 5px;'),m(H,'.trumpet-notif-bottomLeft','width: 340px; position: absolute; left: 10px; bottom: 5px;')}function m(G,H,I,J){J=J||0,G.insertRule?G.insertRule(H+'{'+I+'}',J):G.addRule(H,I,J)}var o,p,q,r,u,v,w,x,y,z,D,A='Trumpet',B='trumpet:',C=!1,E={serverBaseUrl:'http://localhost:3001/',notificationsEndpoint:'',pollInterval:10000,responsePayloadStructure:{titleField:'title',messageField:'message',notificationTypeField:'type',timeStampField:'timestamp'},useNoty:!1,notySettings:{type:'success',layout:'topRight',theme:'metroui',timeout:1e4,progressBar:!0,closeWith:['click','button'],animation:{open:'noty_effects_open',close:'noty_effects_close'},id:!1,modal:!1},notyMojsAnimation:{open:function open(G){var H=this,I=new mojs.Timeline,J=new mojs.Html({el:H.barDom,x:{500:0,delay:0,duration:500,easing:'elastic.out'},isForce3d:!0,onComplete:function onComplete(){G(function(N){N()})}}),K=new mojs.Shape({parent:H.barDom,width:200,height:H.barDom.getBoundingClientRect().height,radius:0,x:_defineProperty({},150,-150),duration:600,isShowStart:!0});H.barDom.style.overflow='visible',K.el.style.overflow='hidden';var L=new mojs.Burst({parent:K.el,count:10,top:H.barDom.getBoundingClientRect().height+75,degree:90,radius:75,angle:_defineProperty({},-90,40),children:{fill:'#EBD761',delay:'stagger(500, -50)',radius:'rand(8, 25)',direction:-1,isSwirl:!0}}),M=new mojs.Burst({parent:K.el,count:2,degree:0,angle:75,radius:{0:100},top:'90%',children:{fill:'#EBD761',pathScale:[0.65,1],radius:'rand(12, 15)',direction:[-1,1],delay:400,isSwirl:!0}});I.add(J,L,M,K),I.play()},close:function close(G){var H=this;new mojs.Html({el:H.barDom,x:{0:500,delay:10,duration:500,easing:'cubic.out'},skewY:{0:10,delay:10,duration:500,easing:'cubic.out'},isForce3d:!0,onComplete:function onComplete(){G(function(I){I()})}}).play()}}},F={init:function init(G){o=G.serverBaseUrl||o||E.serverBaseUrl,p=G.notificationsEndpoint||p||E.notificationsEndpoint,q=G.endpointHeaders||q,r=1e3*G.pollIntervalInSecs||r||E.pollInterval,u=G.callback||u,y=G.position||y,v=G.useNoty||v||E.useNoty,w=G.notySettings||w||E.notySettings,z=G.responsePayloadStructure||z||E.responsePayloadStructure,D=G.apiType||F.API_TYPE.HTTP_SHORT_POLLING,d(),v||(k(),l()),C||(C=!0,f())},API_TYPE:{HTTP_SHORT_POLLING:0,SSE:1,WEB_SOCKET:2}};'object'===('undefined'==typeof exports?'undefined':_typeof(exports))?module.exports=F:'function'==typeof define&&define.amd?define(function(){return F}):a.Trumpet=F})(window);